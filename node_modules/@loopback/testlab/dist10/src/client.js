"use strict";
// Copyright IBM Corp. 2017,2018. All Rights Reserved.
// Node module: @loopback/testlab
// This file is licensed under the MIT License.
// License text available at https://opensource.org/licenses/MIT
Object.defineProperty(exports, "__esModule", { value: true });
/*
 * HTTP client utilities
 */
const http = require("http");
const supertest = require("supertest");
exports.supertest = supertest;
/**
 * Create a SuperTest client connected to an HTTP server listening
 * on an ephemeral port and calling `handler` to handle incoming requests.
 * @param handler
 */
function createClientForHandler(handler) {
    const server = http.createServer(handler);
    return supertest(server);
}
exports.createClientForHandler = createClientForHandler;
async function createClientForRestServer(server) {
    await server.start();
    const port = server.options && server.options.http ? server.options.http.port : 3000;
    const url = `http://127.0.0.1:${port}`;
    // TODO(bajtos) Find a way how to stop the server after all tests are done
    return supertest(url);
}
exports.createClientForRestServer = createClientForRestServer;
//# sourceMappingURL=client.js.map